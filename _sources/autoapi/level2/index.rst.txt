:mod:`level2`
=============

.. py:module:: level2

.. autoapi-nested-parse::

   Created on Mon Jun 17 14:24:10 2019

   Script to generate the C3S CDM Marine level2 data: final release data after visual
   inspection of data.

   The processing unit is the source-deck.

   Outputs included data to:
       - ``/<data_path>/<release>/<source>/level2/<sid-dck>/table[i]-fileID.psv``
   Outputs exluded data to:
       - ``/<data_path>/<release>/<source>/level2/excluded/<sid-dck>/table[i]-fileID.psv``

   where fileID is yyyy-mm-release_tag-update_tag

   Before processing starts:
       - checks the existence of input data subdirectory in level1e -> exits if fails
       - checks the existence of the level2 selection file (level2_list) and that sid-dck is registered in it -> exits if fails
       - checks that a sid-dck to be included has at least an observation table registered to be included  -> exits if fails
       - removes level2 sid-dck subdirs (except log/sid-dck)

   If at any point during copying an exception is raised, cleans sid-dck level2 before exiting.

   Inargs:
   -------
   - data_path: data release parent path (i.e./gws/nopw/c3s311_lot2/data/marine)
   - sid_dck: source-deck partition (sss-ddd)
   - release: release identifier
   - update: release update identifier
   - source: source dataset identifier
   - level2_list: path to file with level2 configuration

   Uses level2_list:
   -----------------
   json file as created by L2_list_create.py, with:

   { 'params_exclude':[],
     'ss1-dd1':{'exclude':True|False,'params_exclude':[]},
     ....
     'ssN-ddN':{'exclude':True|False,'params_exclude':[]}
   }

   @author: iregon



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   level2.script_setup



Functions
~~~~~~~~~

.. autoapisummary::

   level2.clean_level



Attributes
~~~~~~~~~~

.. autoapisummary::

   level2.date_handler
   level2.args
   level2.params
   level2.FFS
   level2.level
   level2.level_prev
   level2.header
   level2.wmode
   level2.left_min_period
   level2.right_max_period
   level2.release_path
   level2.release_id
   level2.prev_level_path
   level2.level_path
   level2.level_excluded_path
   level2.level_reports_path
   level2.data_paths
   level2.cdm_tables
   level2.obs_tables
   level2.include_list
   level2.year_init
   level2.year_end
   level2.init_global
   level2.end_global
   level2.year_init
   level2.year_end
   level2.exclude_sid_dck
   level2.exclude_param_global_list
   level2.exclude_param_sid_dck_list
   level2.exclude_param_list
   level2.include_param_list
   level2.files


.. class:: script_setup(inargs)



.. data:: date_handler
   

   

.. function:: clean_level()


.. data:: args
   

   

.. data:: params
   

   

.. data:: FFS
   :annotation: = -

   

.. data:: level
   :annotation: = level2

   

.. data:: level_prev
   :annotation: = level1e

   

.. data:: header
   :annotation: = True

   

.. data:: wmode
   :annotation: = w

   

.. data:: left_min_period
   :annotation: = 1600

   

.. data:: right_max_period
   :annotation: = 2100

   

.. data:: release_path
   

   

.. data:: release_id
   

   

.. data:: prev_level_path
   

   

.. data:: level_path
   

   

.. data:: level_excluded_path
   

   

.. data:: level_reports_path
   

   

.. data:: data_paths
   

   

.. data:: cdm_tables
   

   

.. data:: obs_tables
   

   

.. data:: include_list
   

   

.. data:: year_init
   

   

.. data:: year_end
   

   

.. data:: init_global
   

   

.. data:: end_global
   

   

.. data:: year_init
   

   

.. data:: year_end
   

   

.. data:: exclude_sid_dck
   

   

.. data:: exclude_param_global_list
   

   

.. data:: exclude_param_sid_dck_list
   

   

.. data:: exclude_param_list
   

   

.. data:: include_param_list
   

   

.. data:: files
   

   

